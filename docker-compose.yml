services:
  # Interactive CLI - run any finbot command
  finbot:
    build: .
    container_name: finbot
    volumes:
      - finbot-data:/app/finbot/data
    env_file:
      - finbot/config/.env
    environment:
      - DYNACONF_ENV=${DYNACONF_ENV:-development}

  # Daily data update pipeline
  finbot-update:
    build: .
    container_name: finbot-update
    entrypoint: ["python", "scripts/update_daily.py"]
    command: []
    volumes:
      - finbot-data:/app/finbot/data
    env_file:
      - finbot/config/.env
    environment:
      - DYNACONF_ENV=${DYNACONF_ENV:-development}

  # Streamlit web dashboard
  finbot-dashboard:
    build: .
    container_name: finbot-dashboard
    entrypoint: ["python", "-m", "streamlit", "run", "finbot/dashboard/app.py", "--server.port", "8501", "--server.address", "0.0.0.0"]
    command: []
    ports:
      - "8501:8501"
    volumes:
      - finbot-data:/app/finbot/data
    env_file:
      - finbot/config/.env
    environment:
      - DYNACONF_ENV=${DYNACONF_ENV:-development}

  # Data status check
  finbot-status:
    build: .
    container_name: finbot-status
    command: ["status"]
    volumes:
      - finbot-data:/app/finbot/data
    environment:
      - DYNACONF_ENV=${DYNACONF_ENV:-development}

volumes:
  finbot-data:
    name: finbot-data
